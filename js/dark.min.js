const rootElement=document.documentElement;const darkModeClassName="dark";const darkModeStorageKey="user-color-scheme";const darkModeTimeKey="user-color-scheme-time";const validColorModeKeys={dark:true,light:true};const invertDarkModeObj={dark:"light",light:"dark"};const setLocalStorage=(key,value)=>{try{localStorage.setItem(key,value)}catch(e){}};const removeLocalStorage=(key)=>{try{localStorage.removeItem(key)}catch(e){}};const getLocalStorage=(key)=>{try{return localStorage.getItem(key)}catch(e){return null}};const getModeFromCSSMediaQuery=()=>{return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"};const resetRootDarkModeClassAndLocalStorage=()=>{rootElement.classList.remove(darkModeClassName);rootElement.classList.remove(invertDarkModeObj[darkModeClassName]);removeLocalStorage(darkModeStorageKey)};const applyCustomDarkModeSettings=(mode)=>{const currentSetting=mode||getLocalStorage(darkModeStorageKey);if(validColorModeKeys[currentSetting]){rootElement.classList.add(currentSetting);rootElement.classList.remove(invertDarkModeObj[currentSetting])}else{resetRootDarkModeClassAndLocalStorage()}};const toggleCustomDarkMode=()=>{let currentSetting=getLocalStorage(darkModeStorageKey);if(validColorModeKeys[currentSetting]){currentSetting=invertDarkModeObj[currentSetting]}else if(currentSetting===null){currentSetting=invertDarkModeObj[getModeFromCSSMediaQuery()]}else{return}setLocalStorage(darkModeStorageKey,currentSetting);setLocalStorage(darkModeTimeKey,+new Date());return currentSetting};const initDarkMode=(nowTime)=>{const lastSunrise=(nowTime.getHours()<5?new Date(nowTime.getFullYear(),nowTime.getMonth(),nowTime.getDate()-1,5):new Date(nowTime.getFullYear(),nowTime.getMonth(),nowTime.getDate(),5)).getTime();const lastSunset=(nowTime.getHours()<23?new Date(nowTime.getFullYear(),nowTime.getMonth(),nowTime.getDate()-1,23):new Date(nowTime.getFullYear(),nowTime.getMonth(),nowTime.getDate(),23)).getTime();const darkModeTime=new Date(parseInt(getLocalStorage(darkModeTimeKey)||"0",10)).getTime();let mode=null;nowTime=nowTime.getTime();if(lastSunrise<lastSunset){if(lastSunset<darkModeTime){applyCustomDarkModeSettings()}else{applyCustomDarkModeSettings(darkModeClassName);mode=darkModeClassName}}else{if(lastSunrise<darkModeTime){applyCustomDarkModeSettings()}else{applyCustomDarkModeSettings(invertDarkModeObj[darkModeClassName]);mode=invertDarkModeObj[darkModeClassName]}}if(mode){setLocalStorage(darkModeStorageKey,mode);setLocalStorage(darkModeTimeKey,+new Date())}};initDarkMode(new Date());